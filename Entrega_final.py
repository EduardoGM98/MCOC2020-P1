from matplotlib.pylab import *
from scipy.integrate import odeint
from leer_eof import leer_eof
from sys import argv

eofname=argv[1]
sat_t, sat_x, sat_y, sat_z, sat_vx, sat_vy, sat_vz=leer_eof(eofname)

eof_out=eofname.replace(".EOF", ".PRED")

O=7.27*10**-5 #rad/s
km3=1000**3
mu=398600.440*km3
def zpj(z,t):
    c=cos(O*t)
    s=sin(O*t)
    R1=array([[c, -s, 0], [s, c, 0], [0, 0, 1]])
    Rp=O*array([[-s, -c, 0], [c, -s, 0], [0, 0, 0]])
    Rpp=(O**2)*array([[-c, s, 0], [-s, -c, 0], [0, 0, 0]])
    x=z[0:3]
    xp=z[3:6] 
    r2=dot(x,x)
    r=sqrt(r2)
    xstill=R1@x 
    rnorm=xstill/r
    Fg=-(mu/r**2)*rnorm
    
    Fx=-5.26659e+25*xstill[0]*xstill[2]**2/((2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2)*(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2) - 4.91634559443164e-8*xstill[0]*(2.633295e+25*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 8.77765e+24)/(2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2)**2 - 778399668309.407*xstill[0]*(-6.547825e+29*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 3.928695e+29*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 6.61965224046959e+15*xstill[0]*(-4.67333271047373e+36*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 4.00571375183463e+36*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.00571375183463e+35)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 4.0393736241613e+23*xstill[0]*(2.09075678182717e+50*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 2.85103197521887e+50*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 9.50343991739623e+49*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.52544757971249e+48)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 - 2.1909897892377e+31*xstill[0]*(-1.11145500827048e+64*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 2.07471601543822e+64*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.1969515473682e+64*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 2.17627554066946e+63*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 6.04520983519295e+61)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 5.27763053103942e+19*xstill[0]*(-7.54485777246598e+42*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 8.38317530273998e+42*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) - 1.79639470773e+42*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 3.00576214651134e+27*xstill[0]*(-1.61248026774459e+57*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 2.60477581712587e+57*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 1.18398900778449e+57*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.31554334198276e+56*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) + 259466556103.136*(1.9643475e+30*xstill[0]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 3.928695e+29*xstill[0]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.6549130601174e+15*(1.86933308418949e+37*xstill[0]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 8.01142750366926e+36*xstill[0]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 6.73228937360216e+22*(-1.2544540690963e+51*xstill[0]*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 1.14041279008755e+51*xstill[0]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.90068798347925e+50*xstill[0]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 + 2.73873723654712e+30*(8.8916400661638e+64*xstill[0]*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 1.24482960926293e+65*xstill[0]*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 4.78780618947282e+64*xstill[0]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 4.35255108133892e+63*xstill[0]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 1.05552610620788e+19*(3.77242888623299e+43*xstill[0]*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 2.51495259082199e+43*xstill[0]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 1.79639470773e+42*xstill[0]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 4.29394592358762e+26*(1.12873618742121e+58*xstill[0]*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) - 1.30238790856294e+58*xstill[0]*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 3.55196702335346e+57*xstill[0]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 1.31554334198276e+56*xstill[0]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2)
    Fy=-5.26659e+25*xstill[1]*xstill[2]**2/((2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2)*(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2) - 4.91634559443164e-8*xstill[1]*(2.633295e+25*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 8.77765e+24)/(2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2)**2 - 778399668309.407*xstill[1]*(-6.547825e+29*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 3.928695e+29*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 6.61965224046959e+15*xstill[1]*(-4.67333271047373e+36*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 4.00571375183463e+36*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.00571375183463e+35)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 4.0393736241613e+23*xstill[1]*(2.09075678182717e+50*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 2.85103197521887e+50*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 9.50343991739623e+49*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.52544757971249e+48)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 - 2.1909897892377e+31*xstill[1]*(-1.11145500827048e+64*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 2.07471601543822e+64*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.1969515473682e+64*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 2.17627554066946e+63*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 6.04520983519295e+61)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 5.27763053103942e+19*xstill[1]*(-7.54485777246598e+42*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 8.38317530273998e+42*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) - 1.79639470773e+42*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 3.00576214651134e+27*xstill[1]*(-1.61248026774459e+57*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 2.60477581712587e+57*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 1.18398900778449e+57*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.31554334198276e+56*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) + 259466556103.136*(1.9643475e+30*xstill[1]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 3.928695e+29*xstill[1]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.6549130601174e+15*(1.86933308418949e+37*xstill[1]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 8.01142750366926e+36*xstill[1]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 6.73228937360216e+22*(-1.2544540690963e+51*xstill[1]*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 1.14041279008755e+51*xstill[1]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.90068798347925e+50*xstill[1]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 + 2.73873723654712e+30*(8.8916400661638e+64*xstill[1]*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 1.24482960926293e+65*xstill[1]*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 4.78780618947282e+64*xstill[1]*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 4.35255108133892e+63*xstill[1]*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 1.05552610620788e+19*(3.77242888623299e+43*xstill[1]*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 2.51495259082199e+43*xstill[1]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 1.79639470773e+42*xstill[1]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 4.29394592358762e+26*(1.12873618742121e+58*xstill[1]*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) - 1.30238790856294e+58*xstill[1]*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 3.55196702335346e+57*xstill[1]*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 1.31554334198276e+56*xstill[1]*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2)
    Fz=-4.91634559443164e-8*xstill[2]*(2.633295e+25*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 8.77765e+24)/(2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2)**2 - 778399668309.407*xstill[2]*(-6.547825e+29*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 3.928695e+29*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 6.61965224046959e+15*xstill[2]*(-4.67333271047373e+36*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 4.00571375183463e+36*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.00571375183463e+35)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 4.0393736241613e+23*xstill[2]*(2.09075678182717e+50*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 2.85103197521887e+50*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 9.50343991739623e+49*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 4.52544757971249e+48)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 - 2.1909897892377e+31*xstill[2]*(-1.11145500827048e+64*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 2.07471601543822e+64*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.1969515473682e+64*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 2.17627554066946e+63*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2) - 6.04520983519295e+61)/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 5.27763053103942e+19*xstill[2]*(-7.54485777246598e+42*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 8.38317530273998e+42*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) - 1.79639470773e+42*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 3.00576214651134e+27*xstill[2]*(-1.61248026774459e+57*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 2.60477581712587e+57*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 1.18398900778449e+57*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.31554334198276e+56*xstill[2]/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) + (-5.26659e+25*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 5.26659e+25*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(2.45817279721582e-8*xstill[0]**2 + 2.45817279721582e-8*xstill[1]**2 + 2.45817279721582e-8*xstill[2]**2) + 1.6549130601174e+15*(1.86933308418949e+37*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 2.67047583455642e+37*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 8.01142750366926e+36*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 6.73228937360216e+22*(-1.2544540690963e+51*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 2.39486685918385e+51*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 1.33048158843547e+51*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 1.90068798347925e+50*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 + 2.73873723654712e+30*(8.8916400661638e+64*xstill[2]**9/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**5 - 2.13399361587931e+65*xstill[2]**7/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 1.72361022821021e+65*xstill[2]**5/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**3 - 5.22306129760671e+64*xstill[2]**3/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**2 + 4.35255108133892e+63*xstill[2]/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**4 + 259466556103.136*(1.9643475e+30*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 2.357217e+30*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 3.928695e+29/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.05552610620788e+19*(3.77242888623299e+43*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) - 6.28738147705498e+43*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 2.69459206159499e+43*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) - 1.79639470773e+42/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) + 4.29394592358762e+26*(1.12873618742121e+58*xstill[2]**8/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(9/2) - 2.43112409598415e+58*xstill[2]**6/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2) + 1.65758461089828e+58*xstill[2]**4/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(5/2) - 3.68352135755174e+57*xstill[2]**2/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(3/2) + 1.31554334198276e+56/sqrt(xstill[0]**2 + xstill[1]**2 + xstill[2]**2))/(xstill[0]**2 + xstill[1]**2 + xstill[2]**2)**(7/2)
    jn=-array([Fx, Fy, Fz])
    
    zp=zeros(6)
    zp[0:3]=xp
    zp[3:6]=R1.T@(Fg+jn-(2*Rp@xp+Rpp@x))
    return zp

z0=[sat_x[0], sat_y[0], sat_z[0], sat_vx[0], sat_vy[0], sat_vz[0]]

sol_odeint= odeint(zpj, z0, sat_t)
x=sol_odeint[:,0]
y=sol_odeint[:,1]
z=sol_odeint[:,2]
vx=sol_odeint[:,3]
vy=sol_odeint[:,4]
vz=sol_odeint[:,5]


i=0
archivo=open(eofname, "r")
with open(eof_out, "w") as fout:
    for linea in archivo:
        if linea[0:8] == "      <X":
            linea = f"      <X unit=\"m\">{x[i]}</X>\n"
            
        if linea[0:8] == "      <Y":
            linea = f"      <Y unit=\"m\">{y[i]}</Y>\n"
            
        if linea[0:8] == "      <Z":
            linea = f"      <Z unit=\"m\">{z[i]}</Z>\n"
            
        if linea[0:9] == "      <VX":
            linea = f"      <VX unit=\"m/s\">{vx[i]}</VX>\n"
            
        if linea[0:9] == "      <VY":
            linea = f"      <VY unit=\"m/s\">{vy[i]}</VY>\n"
            
        if linea[0:9] == "      <VZ":
            linea = f"      <VZ unit=\"m/s\">{vz[i]}</VZ>\n"
            i+=1
            if i==9362:
                break
        fout.write(linea)
        

        
